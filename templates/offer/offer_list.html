{% extends "base.html" %}
{% load humanize %}


{% block content %}
<div class="container my-5">
  <h2 class="fw-bold mb-4 text-center text-primary">Your Purchase Offers</h2>

  {% if offers %}
    <div class="row g-4">
      {% for offer in offers %}
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">
                <a href="{% url 'property-detail' offer.property.id %}" class="text-decoration-none text-dark">
                  {{ offer.property.street_name }}, {{ offer.property.city }}
                </a>
              </h5>

              <p class="mb-1"><strong>Offer Date:</strong> {{ offer.offer_date|date:"Y-m-d" }}</p>
              <p class="mb-1"><strong>Expires:</strong> {{ offer.expiration_date|date:"Y-m-d" }}</p>

              <p class="mb-1">
                <strong>Status:</strong>
                <span class="badge
                  {% if offer.status == 'pending' %}bg-warning text-dark
                  {% elif offer.status == 'rejected' %}bg-danger
                  {% elif offer.status == 'accepted' or offer.status == 'contingent' %}bg-success
                  {% endif %}">
                  {{ offer.status|title }}
                </span>
              </p>

              <p class="mb-1"><strong>Seller:</strong> {{ offer.property.seller.user.get_full_name }}</p>
              <p class="mb-1"><strong>Price:</strong> {{ offer.amount|intcomma }} kr.</p>

              {% if offer.status == 'accepted' or offer.status == 'contingent' %}
                <a href="{% url 'finalize-offer' offer.id %}" class="btn btn-primary btn-sm mt-2">
                  Finalize Offer
                </a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted text-center mt-4">You haven't submitted any purchase offers yet.</p>
  {% endif %}
</div>
{% endblock %}
